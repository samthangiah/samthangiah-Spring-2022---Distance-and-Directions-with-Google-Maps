<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

	<style>
	#map{
		height: 600px;
		width: 100%;
	}
	
	.xcel{
		height: 250px;
		width: 100%;
		overflow-y: scroll;
	}
	</style>
	
	<script> 
	//Used from https://qawithexperts.com/article/javascript/read-csv-file-in-javascript-and-html5-filereader-multiple-wa/238
	//read in csv file, format to html <table>
	function processFile() {
	    var fileSize = 0;
	    //get file
	    var theFile = document.getElementById("myFile");
	     //console.log(theFile);
	     var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/;
	     //check if file is CSV
	     if (regex.test(theFile.value.toLowerCase())) {
	     //check if browser support FileReader
	        if (typeof (FileReader) != "undefined") {
	       //get table element
	        var table = document.getElementById("myTable");
	        var headerLine = "";
	        //create html5 file reader object
	        var myReader = new FileReader();
	        // call filereader. onload function
	        myReader.onload = function(e) {
	            var content = myReader.result;
	            //split csv file using "\n" for new line ( each row)
	            var lines = content.split("\n");
	            //loop all rows
	            for (var count = 0; count < lines.length; count++) {
	                //create a tr element
	                var row = document.createElement("tr");
	                //console.log("#1: " + row);
	                //split each row content
	                var rowContent = lines[count].split(",");
	                //console.log("#2: " + rowContent);
	                //loop throw all columns of a row
	                for (var i = 0; i < rowContent.length; i++) {
	                   //create td element 
	                    var cellElement = document.createElement("td");
	                    if (count == 0) {
	                        cellElement = document.createElement("th");
	                    } else {
	                        cellElement = document.createElement("td");
	                    }
	                    //add a row element as a node for table
	                    var cellContent = document.createTextNode(rowContent[i].replaceAll("\"", ""));
	                    //console.log("#3: " + cellContent);
	                    cellElement.appendChild(cellContent);
	                    //append row child
	                    row.appendChild(cellElement);
	                }
	                //append table contents
	                myTable.appendChild(row);
	            }
	        }
	         //call file reader onload
	          myReader.readAsText(theFile.files[0]);
	        }
	        else 
	        {
	              alert("This browser does not support HTML5.");
	        }
	        
	    }
	    else {
	                alert("Please upload a valid CSV file.");
	    }
	    return false;
	}
	</script>
	
	<script>
	let map;
	//These array are static because I am still having trouble finalizing the incorporation of excel files. 
	//Consider these temporary, as they are used for proof of concept with the Polygons
	let polyLong = [-80.166472,
		-80.162556,
		-80.16223,
		-80.161461,
		-80.152143,
		-80.151502,
		-80.150677,
		-80.143928,
		-80.143067,
		-80.138543,
		-80.137926,
		-80.137747,
		-80.13655,
		-80.136285,
		-80.135978,
		-80.135155,
		-80.13314,
		-80.13188,
		-80.127402,
		-80.127076,
		-80.125487,
		-80.122085,
		-80.118114,
		-80.113362,
		-80.111538,
		-80.101859,
		-80.101525,
		-80.101219,
		-80.099827,
		-80.098294,
		-80.09786,
		-80.096861,
		-80.09431,
		-80.087571,
		-80.087437,
		-80.086694,
		-80.084259,
		-80.083808,
		-80.082457,
		-80.082007,
		-80.080489,
		-80.075938,
		-80.074422,
		-80.073827,
		-80.072044,
		-80.07145,
		-80.071417,
		-80.071375,
		-80.07133,
		-80.071318,
		-80.071286,
		-80.070779,
		-80.069262,
		-80.069015,
		-80.068886,
		-80.068757,
		-80.068676,
		-80.06848,
		-80.067649,
		-80.06742,
		-80.067373,
		-80.057716,
		-80.057267,
		-80.056299,
		-80.055923,
		-80.055475,
		-80.054487,
		-80.051526,
		-80.050539,
		-80.049844,
		-80.047759,
		-80.047064,
		-80.046397,
		-80.044402,
		-80.043737,
		-80.043685,
		-80.043531,
		-80.04348,
		-80.043408,
		-80.043196,
		-80.043127,
		-80.043094,
		-80.042996,
		-80.042963,
		-80.042829,
		-80.042096,
		-80.040527,
		-80.038958,
		-80.038377,
		-80.037795,
		-80.035921,
		-80.033657,
		-80.033218,
		-80.03278,
		-80.031139,
		-80.029499,
		-80.029002,
		-80.028737,
		-80.027945,
		-80.027681,
		-80.027085,
		-80.0253,
		-80.024705,
		-80.024685,
		-80.024628,
		-80.02461,
		-80.024248,
		-80.023044,
		-80.018348,
		-80.016783,
		-80.016126,
		-80.014158,
		-80.013502,
		-80.013328,
		-80.012805,
		-80.012632,
		-80.011154,
		-80.006723,
		-80.005246,
		-80.004708,
		-80.003094,
		-80.002557,
		-80.002001,
		-80.000334,
		-79.999779,
		-79.998155,
		-79.994049,
		-79.993284,
		-79.991661,
		-79.991021,
		-79.990634,
		-79.989666,
		-79.989101,
		-79.989064,
		-79.988462,
		-79.988474,
		-79.988136,
		-79.987505,
		-79.987128,
		-79.986989,
		-79.986793,
		-79.986042,
		-79.983789,
		-79.983039,
		-79.982691,
		-79.981771,
		-79.981763,
		-79.98177,
		-79.981698,
		-79.981667,
		-79.981666,
		-79.981527,
		-79.98151,
		-79.98146,
		-79.981456,
		-79.981412,
		-79.981337,
		-79.981304,
		-79.981284,
		-79.981243,
		-79.981237,
		-79.981202,
		-79.981179,
		-79.981172,
		-79.981164,
		-79.981122,
		-79.981106,
		-79.981088,
		-79.98108,
		-79.981077,
		-79.981074,
		-79.981072,
		-79.981067,
		-79.981067,
		-79.981064,
		-79.981061,
		-79.981059,
		-79.981058,
		-79.981036,
		-79.981034,
		-79.981025,
		-79.981029,
		-79.981036,
		-79.98103,
		-79.981015,
		-79.981003,
		-79.981014,
		-79.981001,
		-79.98099,
		-79.980985,
		-79.980971,
		-79.980905,
		-79.980902,
		-79.980901,
		-79.980885,
		-79.98086,
		-79.980834,
		-79.980818,
		-79.980826,
		-79.980851,
		-79.98085,
		-79.980846,
		-79.980814,
		-79.9808,
		-79.980789,
		-79.980787,
		-79.980796,
		-79.980823,
		-79.980839,
		-79.980846,
		-79.980852,
		-79.980872,
		-79.98088,
		-79.980973,
		-79.981089,
		-79.981229,
		-79.981264,
		-79.98099,
		-79.980778,
		-79.980409,
		-79.980367,
		-79.979983,
		-79.979916,
		-79.979901,
		-79.979867,
		-79.979822,
		-79.979785,
		-79.979784,
		-79.979645,
		-79.979207,
		-79.979206,
		-79.979052,
		-79.979031,
		-79.979009,
		-79.979,
		-79.978906,
		-79.978869,
		-79.978852,
		-79.978552,
		-79.978515,
		-79.97837,
		-79.978213,
		-79.978174,
		-79.977875,
		-79.977834,
		-79.97779,
		-79.977758,
		-79.977749,
		-79.977723,
		-79.977715,
		-79.977433,
		-79.977272,
		-79.97722,
		-79.977187,
		-79.97718,
		-79.976801,
		-79.976627,
		-79.976623,
		-79.975823,
		-79.974848,
		-79.974465,
		-79.974377,
		-79.974391,
		-79.974042,
		-79.973998,
		-79.973705,
		-79.9734,
		-79.973097,
		-79.972402,
		-79.972489,
		-79.973302,
		-79.97375,
		-79.97395,
		-79.974869,
		-79.975155,
		-79.976155,
		-79.976327,
		-79.978367,
		-79.978646,
		-79.978792,
		-79.979065,
		-79.979083,
		-79.979617,
		-79.980862,
		-79.981485,
		-79.986889,
		-79.9872,
		-79.991406,
		-79.992863,
		-79.994262,
		-79.995322,
		-79.999128,
		-80.003754,
		-80.015785,
		-80.023429,
		-80.024844,
		-80.025267,
		-80.025982,
		-80.045052,
		-80.053663,
		-80.054288,
		-80.05624,
		-80.063557,
		-80.064071,
		-80.064906,
		-80.067767,
		-80.068087,
		-80.070567,
		-80.075391,
		-80.075626,
		-80.083514,
		-80.084582,
		-80.094844,
		-80.096502,
		-80.097643,
		-80.097737,
		-80.097833,
		-80.098031,
		-80.099425,
		-80.099942,
		-80.101211,
		-80.111017,
		-80.111338,
		-80.116903,
		-80.118057,
		-80.118397,
		-80.118637,
		-80.118686,
		-80.12051,
		-80.121013,
		-80.122324,
		-80.125512,
		-80.128463,
		-80.131051,
		-80.135101,
		-80.138065,
		-80.148044,
		-80.149992,
		-80.150021,
		-80.150049,
		-80.152243,
		-80.154393,
		-80.158368,
		-80.158855,
		-80.160246,
		-80.160295,
		-80.16034,
		-80.160349,
		-80.160357,
		-80.160726,
		-80.161019,
		-80.161118,
		-80.161216,
		-80.161415,
		-80.161465,
		-80.161784,
		-80.162004,
		-80.162258,
		-80.162556,
		-80.162693,
		-80.162884,
		-80.163019,
		-80.163027,
		-80.163032,
		-80.163061,
		-80.163304,
		-80.16338,
		-80.163383,
		-80.163412,
		-80.163427,
		-80.163733,
		-80.163725,
		-80.163734,
		-80.163744,
		-80.163766,
		-80.163795,
		-80.164132,
		-80.164638,
		-80.164664,
		-80.164678,
		-80.164683,
		-80.164683,
		-80.164875,
		-80.165156,
		-80.165243,
		-80.165247,
		-80.165293,
		-80.165321,
		-80.165527,
		-80.165776,
		-80.166372,
		-80.166444,
		-80.166472,
	];
	let polyLat = [41.000928,
		41.004959,
		41.005295,
		41.006086,
		41.015678,
		41.016335,
		41.017186,
		41.024129,
		41.025003,
		41.029682,
		41.030313,
		41.030496,
		41.031721,
		41.031992,
		41.032305,
		41.033148,
		41.035208,
		41.036511,
		41.041144,
		41.041482,
		41.043125,
		41.046592,
		41.050724,
		41.055607,
		41.057481,
		41.067401,
		41.067744,
		41.068057,
		41.069484,
		41.071054,
		41.070675,
		41.069804,
		41.072333,
		41.079016,
		41.079149,
		41.079954,
		41.082595,
		41.083082,
		41.084545,
		41.085033,
		41.086484,
		41.09084,
		41.092292,
		41.092927,
		41.094835,
		41.095471,
		41.095509,
		41.095559,
		41.095612,
		41.095625,
		41.095664,
		41.096206,
		41.097832,
		41.098098,
		41.098236,
		41.098375,
		41.098462,
		41.098671,
		41.099563,
		41.09981,
		41.09986,
		41.109735,
		41.110193,
		41.111185,
		41.111569,
		41.112028,
		41.113038,
		41.116069,
		41.11708,
		41.117792,
		41.119928,
		41.12064,
		41.121372,
		41.123573,
		41.124306,
		41.124353,
		41.124496,
		41.124543,
		41.124613,
		41.124827,
		41.124899,
		41.124931,
		41.125028,
		41.12506,
		41.125218,
		41.126081,
		41.127781,
		41.129481,
		41.130112,
		41.130743,
		41.132775,
		41.135229,
		41.135704,
		41.136178,
		41.137958,
		41.139738,
		41.140276,
		41.140562,
		41.14142,
		41.141707,
		41.142352,
		41.144287,
		41.144933,
		41.144953,
		41.145014,
		41.145035,
		41.145426,
		41.146732,
		41.151824,
		41.153522,
		41.154233,
		41.156367,
		41.157079,
		41.157267,
		41.157833,
		41.158022,
		41.159624,
		41.16443,
		41.166033,
		41.166615,
		41.168361,
		41.168944,
		41.169527,
		41.171277,
		41.171861,
		41.171875,
		41.171913,
		41.171916,
		41.171924,
		41.171927,
		41.171929,
		41.171938,
		41.171943,
		41.171944,
		41.171948,
		41.171961,
		41.171952,
		41.171952,
		41.171945,
		41.171942,
		41.171928,
		41.171907,
		41.171846,
		41.171826,
		41.171824,
		41.171818,
		41.171471,
		41.169758,
		41.166484,
		41.164106,
		41.164027,
		41.153369,
		41.1516,
		41.146294,
		41.145845,
		41.144527,
		41.138715,
		41.136221,
		41.134702,
		41.131521,
		41.131049,
		41.128421,
		41.126622,
		41.126134,
		41.125472,
		41.122272,
		41.121613,
		41.119252,
		41.11904,
		41.118821,
		41.118679,
		41.118418,
		41.118117,
		41.118016,
		41.117872,
		41.11762,
		41.117441,
		41.117361,
		41.115659,
		41.115533,
		41.115443,
		41.11541,
		41.115389,
		41.115218,
		41.114046,
		41.113988,
		41.113931,
		41.112953,
		41.112087,
		41.111616,
		41.110672,
		41.105635,
		41.105377,
		41.105346,
		41.104394,
		41.102904,
		41.101445,
		41.100463,
		41.100305,
		41.099833,
		41.099674,
		41.09916,
		41.097866,
		41.0951,
		41.092888,
		41.092741,
		41.092293,
		41.090829,
		41.089986,
		41.089565,
		41.089234,
		41.08812,
		41.087748,
		41.082682,
		41.076392,
		41.068773,
		41.066859,
		41.05965,
		41.054079,
		41.044394,
		41.043292,
		41.033195,
		41.031432,
		41.031051,
		41.030152,
		41.028962,
		41.02801,
		41.027992,
		41.026188,
		41.020473,
		41.020456,
		41.016721,
		41.016188,
		41.015659,
		41.015465,
		41.013077,
		41.0123,
		41.01189,
		41.004621,
		41.003668,
		41.000209,
		40.996502,
		40.995569,
		40.988251,
		40.987553,
		40.986335,
		40.985422,
		40.985209,
		40.984571,
		40.984359,
		40.977528,
		40.973649,
		40.97238,
		40.971894,
		40.971846,
		40.969198,
		40.968274,
		40.968012,
		40.962514,
		40.95614,
		40.94584,
		40.942774,
		40.94155,
		40.933249,
		40.932014,
		40.923587,
		40.915061,
		40.906396,
		40.886679,
		40.886679,
		40.886665,
		40.886659,
		40.886663,
		40.886643,
		40.886645,
		40.886625,
		40.886622,
		40.886592,
		40.886589,
		40.886587,
		40.886584,
		40.886584,
		40.886567,
		40.886557,
		40.886548,
		40.886494,
		40.886466,
		40.886388,
		40.886364,
		40.886338,
		40.88632,
		40.886252,
		40.88617,
		40.88595,
		40.885811,
		40.88579,
		40.88578,
		40.885764,
		40.885415,
		40.885255,
		40.885243,
		40.885203,
		40.88507,
		40.885063,
		40.885048,
		40.884996,
		40.884989,
		40.88504,
		40.885139,
		40.885132,
		40.885312,
		40.885328,
		40.88554,
		40.885574,
		40.885597,
		40.885599,
		40.885609,
		40.885605,
		40.885634,
		40.885644,
		40.885671,
		40.885872,
		40.885879,
		40.886003,
		40.886026,
		40.886024,
		40.886028,
		40.88603,
		40.886068,
		40.886078,
		40.886105,
		40.886174,
		40.88624,
		40.886285,
		40.886368,
		40.886436,
		40.886638,
		40.886674,
		40.886675,
		40.886676,
		40.886727,
		40.886765,
		40.88687,
		40.886882,
		40.886906,
		40.887805,
		40.888595,
		40.888796,
		40.888923,
		40.895716,
		40.901091,
		40.902906,
		40.904691,
		40.908346,
		40.909241,
		40.915121,
		40.919094,
		40.923794,
		40.929232,
		40.931773,
		40.935151,
		40.937735,
		40.937887,
		40.937973,
		40.938468,
		40.942957,
		40.944355,
		40.944406,
		40.944936,
		40.945208,
		40.95081,
		40.950823,
		40.950832,
		40.951011,
		40.951411,
		40.951951,
		40.958093,
		40.967376,
		40.967806,
		40.968058,
		40.968143,
		40.968154,
		40.97161,
		40.976679,
		40.978241,
		40.97832,
		40.979148,
		40.979752,
		40.983649,
		40.988125,
		40.999096,
		41.000404,
		41.000928,
];
	var myLatLng = new Array(polyLong.length);
	
	function initMap(){

		map = new google.maps.Map(document.getElementById("map"), {
			zoom: 7,
			center: {lat: 40.7033 , lng: -77.5945 },
			streetViewControl: false,		
		});
		
		var path = new google.maps.MVCArray();
		for(let i = 0; i < polyLong.length; i++){
			myLatLng[i] = new google.maps.LatLng(polyLat[i], polyLong[i]);
			path.push(myLatLng[i]);
		}
		console.log("first literal = " + myLatLng[0]);
	
		
		const SlippyPebble = new google.maps.Polygon({
			fillColor: "#FF0000",
			fillOpacity: 0.1,
			Map: map,
			paths: path,
		});
	
	}
	
	function test(){
		var myFrame = document.getElementById("thisfile");
		var inner = myFrame.contentDocument;
		
		console.log(inner);
	}
	
	
	
	</script>
	
<meta charset="ISO-8859-1">
<title>Polygons and Routing</title>
</head>
<body onload="initMap">
<h1>Polygons with Clustered Routes</h1>
	<hr>
	<form action="/distance-matrix">
			<button type="submit">To Home</button>
	</form>
	
	<p>Upload or select <i>.csv</i> file</p>
	<input id="myFile" type="file">
		<button onclick='processFile()'>Process</button>
		<div  class="xcel">
		<table id="myTable" border=".5" bordercolor="#A9A9A9"></table>
		<div id="dvCSV"></div>
		</div>
	<div id="fileupload">
		
	<!-- <iframe id ="thisfile" class="xcel" src="../../resources/UploadedCSVs/SlipperyRockAreaInfo.htm"></iframe> -->
	</div>
	<!-- <button onclick="test()">Internal Test</button> -->
	
	<div>
        <h2>My Map</h2>
        <hr>
        	<div id="map"></div>
        	
        	<script async defer
    			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD390VrMYSzUckUBYiWeXy2ZvVDrNtWUPg&callback=initMap">
			</script>
			<!-- Script containing methods for building dynamic map on page. Should be moved to its own .js file once issues are resolved or testing is complete -->

	</div>

</body>
</html>